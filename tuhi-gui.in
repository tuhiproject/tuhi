#!/usr/bin/env python3

import gi
import sys
import os
from pathlib import Path

try:
    # 3.30 is the first one with Gtk.Template
    gi.check_version('3.30') # NOQA
except ValueError as e:
    print(e, file=sys.stderr)
    sys.exit(1)

gi.require_version('Gio', '2.0')  # NOQA
from gi.repository import Gio


@devel@  # NOQA
if "TUHI_DEVEL_BUILD_DIR" in os.environ:
    resource_path = Path(os.environ["TUHI_DEVEL_BUILD_DIR"], 'data', 'tuhi.gresource')
else:
    resource_path = Path('@pkgdatadir@', 'tuhi.gresource')
    
resource = Gio.resource_load(os.fspath(resource_path))
Gio.Resource._register(resource)


if __name__ == "__main__":
    import gettext
    import locale

    if "TUHI_DEVEL_BUILD_DIR" in os.environ:
        locale.bindtextdomain('tuhi', Path(os.environ["TUHI_DEVEL_BUILD_DIR"], "po"))
        gettext.bindtextdomain('tuhi', Path(os.environ["TUHI_DEVEL_BUILD_DIR"], "po"))
    else:
        locale.bindtextdomain('tuhi', '@localedir@')
        gettext.bindtextdomain('tuhi', '@localedir@')

    from tuhi.gui.application import main
    main(sys.argv)
